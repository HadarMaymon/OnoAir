<div class="wrapper">
  <div class="main-content">
    <div class="book-flight-container" *ngIf="flight; else notFound">
      <h1>Book a Flight</h1>
      <p><strong>Origin:</strong> {{ flight.origin }} Boarding: {{ flight.date | date: 'dd-MM-yyyy' }} {{ flight.departureTime }}</p>
      <p><strong>Destination:</strong> {{ flight.destination }} Landing: {{ flight.arrivalDate | date: 'dd-MM-yyyy' }} {{ flight.arrivalTime }}</p>
      
      <!-- Number of Passengers -->
      <label for="passengers">No of passengers:</label>
      <input id="passengers" type="number" [(ngModel)]="passengerCount" (change)="updatePassengers()" required min="1" />

      <!-- Passenger Form -->
      <div *ngFor="let passenger of passengers; let i = index">
        <h3>Passenger {{ i + 1 }}</h3>

        <!-- Name Input with Validation -->
        <label for="name-{{ i }}">Name:</label>
        <input id="name-{{ i }}" [(ngModel)]="passenger.name" (blur)="validatePassenger(i)" required />
        <p class="error-message" *ngIf="errors[i]?.name">{{ errors[i].name }}</p>

        <!-- Passport ID Input with Validation -->
        <label for="id-{{ i }}">Passport ID:</label>
        <input id="id-{{ i }}" [(ngModel)]="passenger.id" (blur)="validatePassenger(i)" required />
        <p class="error-message" *ngIf="errors[i]?.id">{{ errors[i].id }}</p>
        <p class="error-message" *ngIf="errors[i]?.duplicateId">{{ errors[i].duplicateId }}</p>
      </div>

      <!-- Save Button -->
      <button mat-raised-button color="primary" (click)="saveBooking()" [disabled]="hasErrors()">Save</button>
    </div>

    <ng-template #notFound>
      <p>Flight not found. Please return to the flight list.</p>
    </ng-template>
  </div>
</div>
