<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Booking Details</title>
    <link rel="stylesheet" href="../header.css">
    <link rel="stylesheet" href="Booking Details.css">
    <script type="module">
        import FlightDetails from './Book A Flight.js';

        document.addEventListener("DOMContentLoaded", function () {
            // Load the header
            fetch('../header.html')
                .then(response => response.text())
                .then(data => {
                    document.getElementById('header-placeholder').innerHTML = data;
                });

            // Load the footer
            fetch('../footer.html')
                .then(response => response.text())
                .then(data => {
                    document.getElementById('footer-placeholder').innerHTML = data;
                });

            // Retrieve flight details from the class and URL
            const urlParams = new URLSearchParams(window.location.search);
            const flightNumber = urlParams.get('flightNumber');

            const flightDetails = new FlightDetails();
            const flights = flightDetails.getFlights();
            const flight = flights.find(flight => flight.flightNumber === flightNumber);

            // Populate flight details
            if (flight) {
                document.getElementById('flight-details').innerHTML = `
                    <strong>Flight No:</strong> ${flight.flightNumber}<br>
                    <strong>Origin:</strong> ${flight.origin}<br>
                    <strong>Destination:</strong> ${flight.destination}<br>
                    <strong>Boarding Time:</strong> ${flight.boarding}<br>
                    <strong>Landing Time:</strong> ${flight.landing}
                `;
            } else {
                document.getElementById('flight-details').innerText = "Flight details not found.";
            }

            // Initialize passenger fields
            updatePassengerFields();
        });

        // Function to dynamically generate passenger fields
        function updatePassengerFields() {
            const numPassengers = parseInt(document.getElementById('num-passengers').value, 10);
            const passengerFieldsContainer = document.getElementById('passenger-fields');

            // Clear existing fields
            passengerFieldsContainer.innerHTML = '';

            // Add fields for each passenger
            for (let i = 1; i <= numPassengers; i++) {
                const passengerDiv = document.createElement('div');
                passengerDiv.className = 'passenger';
                passengerDiv.innerHTML = `
                    <h3>Passenger ${i}</h3>
                    <label for="name-${i}">Full Name:</label>
                    <input type="text" id="name-${i}" name="name-${i}" placeholder="Enter name" required><br>
                    <label for="passport-id-${i}">Passport ID:</label>
                    <input type="text" id="passport-id-${i}" name="passport-id-${i}" placeholder="Enter Passport ID" required><br>
                `;
                passengerFieldsContainer.appendChild(passengerDiv);
            }
        }
    </script>
</head>
<body>
    <!-- Header placeholder -->
    <div id="header-placeholder"></div>

    <div class="container">
        <h1>Booking Details</h1>
        
        <!-- Flight Details Section -->
        <div class="flight-info">
            <p id="flight-details"></p>
        </div>

        <!-- Passenger Information Section -->
        <div>
            <p><strong>No of passengers:</strong></p>
            <input type="number" id="num-passengers" min="1" max="10" value="1" onchange="updatePassengerFields()">
            <div id="passenger-fields"></div>
        </div>

        <button class="save-button">Save</button>
    </div>

    <!-- Footer -->
    <div class="footer">
        <button class="help-button" onclick="window.location.href='/Support.html'">?</button>
    </div>
</body>
</html>
